"use strict";(globalThis.webpackChunkast_block_templates=globalThis.webpackChunkast_block_templates||[]).push([[509],{2509:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var o=a(5711),r=a(5940),s=a(7363),n=a(7009),l=a(5302),c=a(1882),i=a(8096),p=a(5868),m=a(4142),u=a(9148),d=a(6128),g=a(1569),b=a(5622);const f=s.forwardRef((function({title:e,titleId:t,...a},o){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},a),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}));var h=a(8680),y=a(6042),k=a(7712),v=a(6302),w=a(1890);const{post:I}=wp.ajax,{parse:_}=wp.blocks,P=(0,o.Z)((0,r.Z)((e=>{const{getImportItemInfo:t,getCurrentScreen:a,getSitePreview:o,getActiveBlockPaletteSlug:r,getActivePagePaletteSlug:s,getDisableAi:n,getAdaptiveMode:l}=e("ast-block-templates");return{importItemInfo:t(),sitePreview:o(),currentScreen:a(),activeBlockPaletteSlug:r(),activePagePaletteSlug:s(),disableAI:n(),adaptiveMode:l()}})),(0,i.Z)((e=>{const{setImportItemInfo:t,setTogglePopup:a,setOnboardingAiPopup:o}=e("ast-block-templates"),{insertBlocks:r}=wp.data.dispatch("core/block-editor");return{setImportItemInfo:t,onSetTogglePopup:a,insertBlocks:r,setOnboardingAiPopup:o}})))((0,s.memo)((({setImportItemInfo:e,requiredPlugins:t,importItemInfo:a,title:o,btnClass:r,insertBlocks:i,onSetTogglePopup:P,item:E,onClick:S,onBlockImport:x,activeBlockPaletteSlug:R,activePagePaletteSlug:A,currentScreen:N,disableAI:C,importing:O=!1,adaptiveMode:T,showIcon:$=!0})=>{let[j]=(0,s.useState)(a),B=t||[];const Z=r||"",[L]=(0,s.useState)(o||"Import"),{index:D}=wp.data.select("core/block-editor").getBlockInsertionPoint(),{importInProgress:q,stepData:M,syncLibNotice:F}=(0,l.Z)((e=>{const{getImportInProgress:t,getAIStepData:a,getNotice:o}=e(v.L);return{importInProgress:t(),stepData:a(),syncLibNotice:o()}}),[]),{setImportInProgress:W,setSpecAiTogglePopup:z}=(0,c.Z)(v.L),H="info"===F?.type,K=(0,n.gt)(),Q=(e,t,a)=>{(0,y.Am)((0,k.Z)({title:e,message:t}),k.Z.getOptions({type:a}))},U=async()=>{try{await(0,u.j)({slug:"ultimate-addons-for-gutenberg",init:"ultimate-addons-for-gutenberg/ultimate-addons-for-gutenberg.php",name:"Spectra"})}catch(e){W(!1),Q("Import failed!","Spectra activation failed!","error")}},V=()=>{(0,u.j)({slug:"wpforms-lite",init:"wpforms-lite/wpforms.php",name:"WPForms Lite"}).then((()=>{Y()})).catch((()=>{W(!1),Q("Import failed!","WPForms activation failed!","error")}))},G=()=>{const e=j.original_content,t="all-blocks-grid"===N?"block":"page",a="block"===t?j["blocks-category"][0]:j["pages-category"][0];I({action:"ast_block_templates_import_block",content:e,category:a,_ajax_nonce:ast_block_template_vars._ajax_nonce,style:"all-blocks-grid"===N?R:A,disableAI:C,block_type:t,adaptiveMode:T}).done((e=>{W(!1);const t=(0,n.CN)(_(e));i(t,D,"",!1),J(t[0].clientId),P(),document.getElementById("ast-block-templates-modal-wrap").classList.remove("open"),document.body.classList.remove("ast-block-templates-modal-open"),(K.inactive||K.notInstalled)&&(0,b.iP)(),"function"==typeof x&&x(e,D)})).fail((()=>{W(!1),Q("Import failed!","Failed to import the block. Please try again later or contact support for assistance.","error")}))},J=e=>{e&&setTimeout((()=>{const t=X(),a="block-"+e,o=t.getElementById(a);o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}),2500)},X=()=>{const e=document.getElementsByClassName("is-tablet-preview"),t=document.getElementsByClassName("is-mobile-preview");if(0!==e.length||0!==t.length){const a=e[0]||t[0];let o=!1;a&&(o=a.getElementsByTagName("iframe")[0]);const r=o?.contentWindow.document||o?.contentDocument;if(r)return r}return document},Y=()=>{j?.["post-meta"]?.["astra-site-wpforms-path"]||""?I({action:"ast_block_templates_import_wpforms",id:j.id,_ajax_nonce:ast_block_template_vars._ajax_nonce}).done((()=>{G()})).fail((()=>{W(!1),Q("Import failed!","WPForms import failed!","error")})):G()};return M.token?React.createElement(p.Z,{className:(0,n.AK)("min-w-[4.875rem] h-7 hover:shadow-small sp-text-sm",Z,(q&&!O||H)&&"opacity-50 cursor-not-allowed"),type:"button",variant:"primary",onClick:async t=>{q||H||(W(!0),"function"==typeof S&&S(t),K.notInstalled?await(async()=>{try{await(0,u.H)({slug:"ultimate-addons-for-gutenberg",init:"ultimate-addons-for-gutenberg/ultimate-addons-for-gutenberg.php",name:"Spectra"}),await U()}catch(e){W(!1),Q("Import failed!","Spectra installation failed!","error")}})():K.inactive&&await U(),(0,g.I)(E.ID,"astra-blocks").then((t=>{e(t),j=t,B=t?.["post-meta"]?.["astra-blocks-required-plugins"]?d.t.parse(t["post-meta"]["astra-blocks-required-plugins"]):[],B.length?"not-installed"===ast_block_template_vars.wpforms_status?(0,u.H)({slug:"wpforms-lite",init:"wpforms-lite/wpforms.php",name:"WPForms Lite"}).then((()=>{V()})).catch((()=>{W(!1),Q("Import failed!","WPForms installation failed!","error")})):"inactive"===ast_block_template_vars.wpforms_status?V():Y():Y()})).catch((e=>{Q("Import failed!",e,"error"),W(!0)})))},isSmall:!0,hasPrefixIcon:!O&&$},O?React.createElement(m.Z,{className:"h-4 w-4 !shrink-0"}):React.createElement(React.Fragment,null,$&&React.createElement(h.Z,{className:"h-4 w-4 !shrink-0"}),React.createElement("span",{className:"truncate"},L))):React.createElement(p.Z,{className:(0,n.AK)("min-w-[7rem] hover:shadow-small sp-text-sm",Z),type:"button",variant:"primary",onClick:()=>{z(),(0,n.jw)("ast-import",{blockId:E.ID,blockType:E.type,blockPaletteSlug:R,pagePaletteSlug:A})},isSmall:!0,hasPrefixIcon:!0},React.createElement(React.Fragment,null,React.createElement(f,{className:"h-4 w-4 !shrink-0"}),(0,w.__)("Insert","ast-block-templates")))})));var E=a(168);const S=e=>{const t=["skip","logo","fav-icon"];for(const a of t)if(e.includes(a))return!0;return!1},x={linearTween:(e,t,a,o)=>a*e/o+t,easeInQuad:(e,t,a,o)=>a*(e/=o)*e+t,easeOutQuad:(e,t,a,o)=>-a*(e/=o)*(e-2)+t,easeInOutQuad:(e,t,a,o)=>(e/=o/2)<1?a/2*e*e+t:-a/2*(--e*(e-2)-1)+t,easeInCubic:(e,t,a,o)=>a*(e/=o)*e*e+t,easeOutCubic:(e,t,a,o)=>(e/=o,a*(--e*e*e+1)+t),easeInOutCubic:(e,t,a,o)=>(e/=o/2)<1?a/2*e*e*e+t:a/2*((e-=2)*e*e+2)+t};Object.seal(x);const R=x,{spectra_common_styles:A,is_rtl:N}=ast_block_template_vars,C="visible",O=(0,o.Z)((0,r.Z)((e=>{const{getDisableAi:t,getDisablePreview:a,getTogglePopup:o}=e("ast-block-templates");return{disableAi:t(),disablePreview:a(),togglePopup:o()}})))((0,s.memo)((({item:e,content:t,stylesheet:a,astraCustomizer:o,globalStylesheet:r,colorPalette:l,dynamicContent:c,selectedImages:i,disableAi:p,togglePopup:m,email:u,phone:d,address:g})=>{const b=(0,s.useRef)(null),f=(0,s.useRef)(null),h=e["thumbnail-image-url"]||"",y=e["featured-image-url"]||"",k=(0,n.gt)();let v=0,w=0,I=0;const[_,x]=(0,s.useState)({importing:!1}),[O,T]=(0,s.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`),[$,j]=(0,s.useState)(`${ast_block_template_vars.uri}dist/placeholder_200_200.png`);function B(){const e=b?.current,t=f?.current;if(!e||!t)return;const a=e.parentNode.offsetWidth/1200,o=a*t.offsetHeight;e.style.transform=`scale(${a})`,e.style.height=`${o}px`}(0,s.useLayoutEffect)((()=>{let s=!0;const n={landscape:[],portrait:[]};i?.forEach((e=>{"landscape"===e.orientation?n.landscape.push(e):n.portrait.push(e)}));const m=n,b=new Image;b.src=h;const k=new Image;k.src=y;const _=f.current;function P(e,t){s&&(e.onload=()=>{t(e.src)})}P(b,T),P(k,j);const E=document.getElementById("astra-wp-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container"),x=document.getElementById("astra-block-editor-styles-inline-css")?.textContent.replace(/:root/g,".block-container").replace(/body/g,".block-container");let R="";var N,O,$;if(a&&(N=a,O=m?.landscape,a=p?N:0!==Object.keys(c).length&&c.hasOwnProperty(e.category)?O&&0===O.length?N:N.replace(/background-image\s*:\s*url\(['"]?([^'")]+)['"]?\)/g,(function(e,t){if(S(t))return e;if(!O[I]?.url)return"";const a=O[I]?.url;return I++,I%=O.length,'background-image: url("'+a+'")'})):N),R+=o?`<style type="text/css" id="gt-astra-customizer">${o}</style>`:"",R+=`<style type="text/css" id="gt-spectra-common-stylesheet">${A}</style>`,R=a?`${R} <style type="text/css" id="gt-common-stylesheet">${a}</style>`:R,r&&(R+=`<style type="text/css" id="gt-global-stylesheet"> ${r} </style>`),E&&(R+=`<style type="text/css" id="gt-wpeditor-css" > ${E} </style>`),x&&(R+=`<style type="text/css" id="gt-blockeditor-css"> ${x} </style>`),_&&t){let a=_.shadowRoot;if(null===a&&(a=_.attachShadow({mode:"open"})),null===a)return;let o=t;if(!p){const t=c?c[e.category]:[];t&&Object.keys(t)?.length>0&&Object.keys(t).forEach((e=>{o=null!==t[e]?o.replace(e,t[e]):o})),Object.keys(c).length>0&&c.hasOwnProperty(e.category)&&($=o,u&&($=$.replace("contact@example.com",u)),d&&($=$.replace("202-555-0188",d)),g&&($=$.replace("2360 Hood Avenue, San Diego, CA, 92123",g)),o=$,o=L(o))}a.innerHTML=R+'<div class="st-block-container">'+o+"</div>",l.forEach(((e,t)=>{a?.host.style.setProperty(`--ast-global-color-${t}`,e)}));const r=_.shadowRoot.querySelectorAll("img");a&&(r.forEach((t=>{S(t.src)||p||0===m.landscape.length||0===m.portrait.length||0===Object.keys(c).length||!c.hasOwnProperty(e.category)||Z(t,"hidden")})),B(),((t,a)=>{if(p)return;if(0===Object.keys(c).length||!c.hasOwnProperty(e.category))return;const o=a.landscape?a.landscape:[],r=a.portrait?a.portrait:[];0!==o.length&&0!==r.length&&t?.forEach((function(e,t){S(e.src)||(e.onload=()=>{const a=e.getAttribute("src")||"";if(a.includes("unsplash")||a.includes("pexels")||a.includes("pixabay"))return void Z(e,C);const s=(e=>{const t=new Image;return t.src=e,t.width>t.height?"landscape":"portrait"})(e.src);let n;if(v=t%o.length,w=t%r.length,n="landscape"===s?o[v]:r[w],void 0!==n)if(n.url.includes("unsplash")||n.url.includes("pexels")||n.url.includes("pixabay")){if("landscape"===s?(v++,v%=o.length):(w++,w%=r.length),"PICTURE"===e.parentNode.nodeName)e.parentNode.querySelectorAll("source").forEach((e=>{e.setAttribute("srcset",n.optimized_url)})),e.parentNode.querySelector("img").setAttribute("src",n.optimized_url);else{const t=document.createElement("img");t.src=n.optimized_url,e.parentNode.replaceChild(t,e)}Z(e,C)}else Z(e,C);else Z(e,C)},e.onerror=()=>{Z(e,C)})}))})(r,m))}return()=>{s=!1}}),[e,p,c,i]),(0,s.useEffect)((()=>{const e=new ResizeObserver(B);return e.observe(document.documentElement),()=>{e&&e.disconnect()}}),[]),(0,s.useEffect)((()=>{const e=document.querySelector("#ast-block-templates-modal-wrap");if(!e)return;const t=new MutationObserver(B);return t.observe(e,{childList:!0,attributes:!0,subtree:!0}),()=>{t&&t.disconnect()}}),[]),(0,s.useEffect)((()=>{const e=f?.current;if(e){const t=e.shadowRoot;l.forEach(((e,a)=>{null!==t&&t.host.style.setProperty(`--ast-global-color-${a}`,e)}))}}),[l]);const Z=(e,t)=>{e&&(e.style.visibility=t)},L=(e="")=>g?e.replace(/(<iframe[^>]+src="https:\/\/maps\.google\.com\/maps\?q=)([^&]+)(&z=\d+&hl=en&t=m&output=embed&iwloc=near"[^>]*><\/iframe>)/g,`$1${encodeURIComponent(g)}$3`):e;let D=0,q=0;const M=(e,t,a)=>{const o=e.scrollTop,r=t-o;let s=0;const n=function(){s+=20;const t=R.linearTween(s,o,r,a);e.scrollTop=t,s<a&&(D=setTimeout(n,20))};n()};(0,s.useEffect)((()=>{m||(v=0,w=0,I=0)}),[m]);const F=N?"origin-top-right":"origin-top-left";return React.createElement("div",{className:(0,n.AK)("w-full h-fit p-5",!0===_.importing?"importing":"")},React.createElement("div",{className:(0,n.AK)("cursor-pointer relative border border-solid border-border-primary hover:border-accent-spectra transition duration-150 ease-in-out overflow-hidden group",_.importing&&"border-accent-spectra")},React.createElement("div",{className:`thumbnail left-0 m-0 min-h-[auto] overflow-visible text-left top-0 ${F} relative pointer-events-none`,ref:b},React.createElement("div",{className:"absolute w-[1200px] pointer-events-none max-h-[1600px] overflow-hidden",ref:f},!t&&React.createElement("img",{srcSet:`${$}, ${O}`,src:O,alt:"Preview"}),React.createElement("div",{className:"preview"},React.createElement("span",{className:"ast-block-templates-icon ast-block-templates-icon-search"})))),React.createElement("div",{className:"absolute inset-0 grid grid-cols-1 grid-rows-1 place-items-end",onMouseEnter:()=>{if("page"!==e.type)return;const t=f.current;D&&clearTimeout(D),q=setTimeout((()=>{M(t,t.scrollHeight,4e3)}),1e3)},onMouseLeave:()=>{q&&clearTimeout(q);const e=f.current;D&&clearTimeout(D),M(e,0,1500)}},React.createElement("div",{className:(0,n.AK)("opacity-0 group-hover:opacity-100 w-full flex items-center justify-between px-3 py-2 backdrop-blur-sm bg-white/[0.85] shadow-action-buttons transition-all duration-150 ease-in-out",!0===_.importing?"opacity-100":"")},React.createElement(P,{title:k.notInstalled?"Install Spectra & Insert":k.inactive?"Activate Spectra & Insert":"Insert",showIcon:k.active,liveRequest:!0,item:e,importing:_.importing,onClick:()=>{x({..._,importing:!0})},onBlockImport:()=>{x({..._,importing:!1})}}),React.createElement(E.Z,{item:e})))))})))}}]);